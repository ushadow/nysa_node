<!DOCTYPE html>
<html>
  <head>
    <title>Nysa web control</title>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script src="http://cdn.binaryjs.com/0/binary.js"></script>
    <script src="client.js"></script>
    <link rel="stylesheet" href="client.css">
</head>
<body style="background-size:cover">
<main>
  <h1>Nysa Web Control</h1>
  <div>
    <label>GPIO 0</label>
    <input type="checkbox" id="gpio0">
  </div>
  <div>
    <label>GPIO 1</label>
    <input type="checkbox" id="gpio1">
  </div>
  <div>
    <label>Video</label>
    <input type="checkbox" id="video">
  <canvas></canvas>

  <input type="file" id="fileinput" accept="image/*" capture="camera" />

  <script type="text/javascript">

    // connect to the same host this was served from
    var client = new BinaryClient('ws://' + document.location.host);

    client.on('stream', function(stream, meta){

      // collect stream data
      var parts = [];
      stream.on('data', function(data){
        parts.push(data);
      });

      // when finished, set it as the background image
      stream.on('end', function(){
        var url = (window.URL || window.webkitURL).createObjectURL(new Blob(parts));
        document.body.style.backgroundImage = 'url(' + url + ')';
      });
    });

    // listen for a file being chosen
    fileinput.addEventListener('change', function(event){
        var file = event.target.files[0];
        client.send(file);
    }, false);

  </script>
</main>
</body>
</html>
